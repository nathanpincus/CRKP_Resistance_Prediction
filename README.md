# CRKP Resistance Prediction
Scripts to perform machine learning analyses in “Genomic features associated with the extent of phenotypic resistance to carbapenems in a collection of carbapenem-resistant Klebsiella pneumoniae isolates“. Results using the Support Vector Classifier algorithm are included in the manuscript. Other algorithms (Random Forest, L2-regularized Logistic Regression, Elastic Net Logistic Regression) were considered for comparison with similar results.

## Dependencies
Analyses were performed in Python v3.6.12 with the following modules:  
scikit-learn v0.23.2  
pandas v1.1.5  
numpy v1.19.2  
matplotlib v3.3.2  

Function for constructing learning curves is included in https://github.com/nathanpincus/PA_Virulence_Prediction

## Input Data
Input data to run these analyses as performed in the manuscript is provided in the Data directory.

## Running
Paths for the input data (and required functions) need to be specified in each script.

Some scripts (e.g. ST258_Imi_Curated_SVC_f1Tuned_manualCV.py) utilize input data (saved as .pkl files) generated by other scripts

Except for ###_StratKF_split.py scripts (which only split the data into training/test sets for manual nested cross-validation), scripts were run using 24 cores

An example R script included for plotting nested cross-validation results is included. This expects CSV output from each fold as determined through a single ###_manualCV.py script to be present in the specified directory.
